python send.py 
python recv.py


################################################## python send.py 

root@vllm-prefill-5cc8f99684-p8bf2:/app# python send.py 
Rank 0: Initial tensor = tensor([0.], device='cuda:0')
Rank 0 sending tensor tensor([0.], device='cuda:0') to rank 1
[rank0]:[W1123 19:27:58.845273115 ProcessGroupNCCL.cpp:3996] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:140 NCCL WARN NUMA auto balancing enabled which can lead to variability in the RCCL performance! Disable by "sudo sysctl kernel.numa_balancing=0"
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO Kernel version: 6.1.0-39-amd64

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:161 NCCL WARN Missing "iommu=pt" from kernel command line which can lead to system instablity or hang!
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO Bootstrap: Using eth0:10.108.2.223<0>
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO ROCr version 1.18
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO Dmabuf feature disabled without NCCL_DMABUF_ENABLE=1

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:140 NCCL WARN NUMA auto balancing enabled which can lead to variability in the RCCL performance! Disable by "sudo sysctl kernel.numa_balancing=0"
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO Kernel version: 6.1.0-39-amd64

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:161 NCCL WARN Missing "iommu=pt" from kernel command line which can lead to system instablity or hang!
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO RCCL version : 2.26.6-HEAD:f224e2c
HIP version  : 7.0.51831-a3e329ad8
ROCm version : 7.0.0.0-38-9428210
Hostname     : vllm-prefill-5cc8f99684-p8bf2
Librccl path : /opt/rocm/lib/librccl.so.1
vllm-prefill-5cc8f99684-p8bf2:4501:4501 [0] NCCL INFO Comm config Blocking set to 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO NET/Plugin: Could not find: librccl-net.so. Using internal net plugin.
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [2]mlx5_2:1/RoCE [3]mlx5_3:1/RoCE [4]mlx5_4:1/RoCE [5]mlx5_5:1/RoCE [6]mlx5_6:1/RoCE [7]mlx5_7:1/RoCE [RO]; OOB eth0:10.108.2.223<0>
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Found /sys/kernel/mm/memory_peers/amdkfd/version
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO PROFILER/Plugin: Could not find: librccl-profiler.so. 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Using network IB
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 3; gpu_id = 27976; unique_id = 4971563420770962324; location_id = 35584; bdf = 35584; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 7; gpu_id = 46417; unique_id = 5164034830744375558; location_id = 43776; bdf = 43776; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 2; gpu_id = 43855; unique_id = 6426859132731320425; location_id = 33536; bdf = 33536; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 9; gpu_id = 31068; unique_id = 12237024594166991327; location_id = 47872; bdf = 47872; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 6; gpu_id = 29526; unique_id = 14780089557571471585; location_id = 41728; bdf = 41728; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 5; gpu_id = 41285; unique_id = 16632971939726001210; location_id = 39680; bdf = 39680; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 8; gpu_id = 48987; unique_id = 16820457183120354875; location_id = 45824; bdf = 45824; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO [node_id = 4; gpu_id = 26434; unique_id = 17491266153520916041; location_id = 37632; bdf = 37632; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO initialized internal alternative rsmi functionality
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO ncclCommInitRankConfig_impl comm 0xb117f60 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 83000 commId 0xcadba9d5577ad454 - Init START
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO RAS client listening socket at ::1<28028>
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Bootstrap timings total 0.001006 (create 0.000056, send 0.000126, recv 0.000285, ring 0.000184, delay 0.000001)
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO initialized internal alternative rsmi functionality
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Setting affinity for GPU 0 to ffff,ffffffff,ffffffff
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO comm 0xb117f60 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 00/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 01/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 02/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 03/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 04/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 05/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 06/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 07/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 08/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 09/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 10/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 11/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 12/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 13/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 14/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 15/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 16/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 17/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 18/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 19/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 20/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 21/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 22/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 23/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 24/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 25/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 26/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 27/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 28/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 29/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 30/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 31/32 : 0 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/-1/-1->0->-1 [3] -1/-1/-1->0->1 [4] 1/-1/-1->0->-1 [5] -1/-1/-1->0->1 [6] 1/-1/-1->0->-1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] -1/-1/-1->0->1 [10] 1/-1/-1->0->-1 [11] -1/-1/-1->0->1 [12] 1/-1/-1->0->-1 [13] -1/-1/-1->0->1 [14] 1/-1/-1->0->-1 [15] -1/-1/-1->0->1 [16] 1/-1/-1->0->-1 [17] -1/-1/-1->0->1 [18] 1/-1/-1->0->-1 [19] -1/-1/-1->0->1 [20] 1/-1/-1->0->-1 [21] -1/-1/-1->0->1 [22] 1/-1/-1->0->-1 [23] -1/-1/-1->0->1 [24] 1/-1/-1->0->-1 [25] -1/-1/-1->0->1 [26] 1/-1/-1->0->-1 [27] -1/-1/-1->0->1 [28] 1/-1/-1->0->-1 [29] -1/-1/-1->0->1 [30] 1/-1/-1->0->-1 [31] -1/-1/-1->0->1 comm 0xb117f60 nRanks 02 busId 83000
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO P2P Chunksize set to 524288
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 1 directMode 0
vllm-prefill-5cc8f99684-p8bf2:4501:4663 [0] NCCL INFO [Proxy Service] Device 0 CPU core 5
vllm-prefill-5cc8f99684-p8bf2:4501:4664 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 10
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 00/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 01/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 02/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 03/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 04/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 05/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 06/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 07/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 08/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 09/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 10/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 11/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 12/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 13/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 14/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 15/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 16/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 17/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 18/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 19/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 20/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 21/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 22/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 23/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 24/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 25/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 26/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 27/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 28/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 29/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 30/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Channel 31/0 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Connected all trees
vllm-prefill-5cc8f99684-p8bf2:4501:4665 [0] NCCL INFO [Proxy Progress] Device 0 CPU core 29
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 256 | 256
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO 32 coll channels, 32 collnet channels, 0 nvls channels, 32 p2p channels, 8 p2p channels per peer
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO CC Off, workFifoBytes 4194304
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO RCCL Unroll Factor (pre-set): 2
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO TUNER/Plugin: Could not find: librccl-tuner.so. Using internal tuner plugin.
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO ncclCommInitRankConfig_impl comm 0xb117f60 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 83000 commId 0xcadba9d5577ad454 - Init COMPLETE
vllm-prefill-5cc8f99684-p8bf2:4501:4641 [0] NCCL INFO Init timings - ncclCommInitRankConfig_impl: rank 0 nranks 2 total 2.77 (kernels 2.40, alloc 0.08, bootstrap 0.00, allgathers 0.00, topo 0.09, graphs 0.00, connections 0.20, rest 0.00)
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 08/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 09/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 10/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 11/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 12/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 13/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 14/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4667 [0] NCCL INFO Channel 15/1 : 0[83000] -> 1[8b000] via P2P/IPC comm 0xb117f60 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4501:4670 [0] NCCL INFO comm 0xb117f60 rank 0 nranks 2 cudaDev 0 busId 83000 - Destroy COMPLETE


################################################## python recv.py


root@vllm-prefill-5cc8f99684-p8bf2:/app# python recv.py
[rank1]:[W1123 19:27:58.763020050 ProcessGroupNCCL.cpp:3996] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO ROCr version 1.18
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO Dmabuf feature disabled without NCCL_DMABUF_ENABLE=1

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:140 NCCL WARN NUMA auto balancing enabled which can lead to variability in the RCCL performance! Disable by "sudo sysctl kernel.numa_balancing=0"
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO Kernel version: 6.1.0-39-amd64

[2025-11-23 19:27:58] vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] /longer_pathname_so_that_rpms_can_support_packaging_the_debug_info_for_all_os_profiles/src/out/ubuntu-22.04/22.04/build/rccl/hipify/src/init.cc:161 NCCL WARN Missing "iommu=pt" from kernel command line which can lead to system instablity or hang!
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO Bootstrap: Using eth0:10.108.2.223<0>
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO RCCL version : 2.26.6-HEAD:f224e2c
HIP version  : 7.0.51831-a3e329ad8
ROCm version : 7.0.0.0-38-9428210
Hostname     : vllm-prefill-5cc8f99684-p8bf2
Librccl path : /opt/rocm/lib/librccl.so.1
vllm-prefill-5cc8f99684-p8bf2:4566:4566 [1] NCCL INFO Comm config Blocking set to 1
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO NET/Plugin: Could not find: librccl-net.so. Using internal net plugin.
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [2]mlx5_2:1/RoCE [3]mlx5_3:1/RoCE [4]mlx5_4:1/RoCE [5]mlx5_5:1/RoCE [6]mlx5_6:1/RoCE [7]mlx5_7:1/RoCE [RO]; OOB eth0:10.108.2.223<0>
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Found /sys/kernel/mm/memory_peers/amdkfd/version
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO PROFILER/Plugin: Could not find: librccl-profiler.so. 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Using network IB
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 3; gpu_id = 27976; unique_id = 4971563420770962324; location_id = 35584; bdf = 35584; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 7; gpu_id = 46417; unique_id = 5164034830744375558; location_id = 43776; bdf = 43776; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 2; gpu_id = 43855; unique_id = 6426859132731320425; location_id = 33536; bdf = 33536; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 9; gpu_id = 31068; unique_id = 12237024594166991327; location_id = 47872; bdf = 47872; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 6; gpu_id = 29526; unique_id = 14780089557571471585; location_id = 41728; bdf = 41728; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 5; gpu_id = 41285; unique_id = 16632971939726001210; location_id = 39680; bdf = 39680; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 8; gpu_id = 48987; unique_id = 16820457183120354875; location_id = 45824; bdf = 45824; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO [node_id = 4; gpu_id = 26434; unique_id = 17491266153520916041; location_id = 37632; bdf = 37632; domain = 0; partition = 0], 
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO initialized internal alternative rsmi functionality
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO ncclCommInitRankConfig_impl comm 0x14b3a5f0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 8b000 commId 0xcadba9d5577ad454 - Init START
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO RAS client listening socket at ::1<28028>
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Bootstrap timings total 1.402995 (create 0.000060, send 0.000134, recv 1.402235, ring 0.000023, delay 0.000000)
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO initialized internal alternative rsmi functionality
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Setting affinity for GPU 1 to ffff,ffffffff,ffffffff
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO comm 0x14b3a5f0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] 0/-1/-1->1->-1 [2] -1/-1/-1->1->0 [3] 0/-1/-1->1->-1 [4] -1/-1/-1->1->0 [5] 0/-1/-1->1->-1 [6] -1/-1/-1->1->0 [7] 0/-1/-1->1->-1 [8] -1/-1/-1->1->0 [9] 0/-1/-1->1->-1 [10] -1/-1/-1->1->0 [11] 0/-1/-1->1->-1 [12] -1/-1/-1->1->0 [13] 0/-1/-1->1->-1 [14] -1/-1/-1->1->0 [15] 0/-1/-1->1->-1 [16] -1/-1/-1->1->0 [17] 0/-1/-1->1->-1 [18] -1/-1/-1->1->0 [19] 0/-1/-1->1->-1 [20] -1/-1/-1->1->0 [21] 0/-1/-1->1->-1 [22] -1/-1/-1->1->0 [23] 0/-1/-1->1->-1 [24] -1/-1/-1->1->0 [25] 0/-1/-1->1->-1 [26] -1/-1/-1->1->0 [27] 0/-1/-1->1->-1 [28] -1/-1/-1->1->0 [29] 0/-1/-1->1->-1 [30] -1/-1/-1->1->0 [31] 0/-1/-1->1->-1 comm 0x14b3a5f0 nRanks 02 busId 8b000
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO P2P Chunksize set to 524288
vllm-prefill-5cc8f99684-p8bf2:4566:4662 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 28
vllm-prefill-5cc8f99684-p8bf2:4566:4661 [1] NCCL INFO [Proxy Service] Device 1 CPU core 24
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 00/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 01/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 02/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 03/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 04/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 05/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 06/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 07/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 08/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 09/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 10/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 11/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 12/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 13/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 14/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 15/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 16/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 17/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 18/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 19/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 20/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 21/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 22/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 23/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 24/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 25/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 26/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 27/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 28/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 29/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 30/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Channel 31/0 : 1[8b000] -> 0[83000] via P2P/IPC comm 0x14b3a5f0 nRanks 02
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Connected all trees
vllm-prefill-5cc8f99684-p8bf2:4566:4666 [1] NCCL INFO [Proxy Progress] Device 1 CPU core 44
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 256 | 256
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO 32 coll channels, 32 collnet channels, 0 nvls channels, 32 p2p channels, 8 p2p channels per peer
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO RCCL Unroll Factor (pre-set): 2
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO TUNER/Plugin: Could not find: librccl-tuner.so. Using internal tuner plugin.
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO ncclCommInitRankConfig_impl comm 0x14b3a5f0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 8b000 commId 0xcadba9d5577ad454 - Init COMPLETE
vllm-prefill-5cc8f99684-p8bf2:4566:4642 [1] NCCL INFO Init timings - ncclCommInitRankConfig_impl: rank 1 nranks 2 total 2.77 (kernels 1.00, alloc 0.08, bootstrap 1.40, allgathers 0.01, topo 0.08, graphs 0.00, connections 0.20, rest 0.00)

Rank 1 received tensor tensor([0.], device='cuda:1') from rank 0

vllm-prefill-5cc8f99684-p8bf2:4566:4672 [1] NCCL INFO comm 0x14b3a5f0 rank 1 nranks 2 cudaDev 1 busId 8b000 - Destroy COMPLETE


